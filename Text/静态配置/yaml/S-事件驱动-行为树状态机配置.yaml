# 混沌世界 - 事件驱动系统行为树与状态机配置
# 基于：S-事件驱动系统.md 策划案
# 版本：V1.0
# 说明：AI决策与玩家选择双重架构的行为树和四层状态机配置

# ==================== 行为树架构配置 ====================
行为树系统:
  根节点配置:
    节点名称: "角色人格驱动器"
    节点类型: "选择器"
    优先级: "最高"
    
    子节点:
      - "AI自动决策分支"
      - "玩家选择介入分支"
    
    权重计算:
      人性特质影响: "不同特质组合产生不同的行为倾向权重"
      社会化阶段调节: "同一行为在不同人生阶段有不同优先级"
      情境压力修正: "生存压力、社会压力、道德压力动态调整行为选择"
      觉醒者特殊分支: "前世记忆影响下的特殊行为模式"
      玩家介入权重: "重要决策点自动暂停，等待玩家选择"
      AI学习机制: "根据玩家历史选择调整AI决策倾向"

  # AI自动决策分支配置
  AI自动决策分支:
    分支名称: "AI自动决策分支"
    分支类型: "并行器"
    适用场景: ["NPC行为", "战斗AI", "日常生活"]
    
    事实层行为分支:
      节点名称: "事实层行为分支"
      节点类型: "选择器"
      权重计算: "基于当前需求和环境状况"
      
      子行为:
        生存需求响应:
          行为类型: "生存行为"
          触发条件:
            健康状况: "<50"
            饥饿程度: ">70"
            安全威胁: ">30"
          行为选项:
            - "寻找食物"
            - "寻求医疗"
            - "逃避危险"
            - "寻找庇护"
          权重因子:
            生存本能: "×2.0"
            理性思考: "×0.5"
        
        社交互动执行:
          行为类型: "社交行为"
          触发条件:
            社交需求: ">40"
            孤独感: ">60"
            社交机会: ">0"
          行为选项:
            - "主动交谈"
            - "参与活动"
            - "寻求帮助"
            - "提供帮助"
          权重因子:
            外向性格: "×1.5"
            社交技能: "×1.2"
        
        技能学习实践:
          行为类型: "学习行为"
          触发条件:
            技能需求: ">30"
            学习机会: ">0"
            时间充裕: ">50"
          行为选项:
            - "向师父请教"
            - "自主练习"
            - "观察学习"
            - "实践应用"
          权重因子:
            求知欲: "×1.8"
            专注力: "×1.3"
    
    观点层认知分支:
      节点名称: "观点层认知分支"
      节点类型: "序列器"
      权重计算: "基于认知能力和信息处理需求"
      
      子行为:
        信息收集分析:
          行为类型: "认知行为"
          触发条件:
            信息缺失: ">40"
            决策需求: ">30"
          行为选项:
            - "主动询问"
            - "观察环境"
            - "回忆经验"
            - "逻辑推理"
          权重因子:
            智慧属性: "×1.5"
            好奇心: "×1.2"
        
        他人评价更新:
          行为类型: "社会认知"
          触发条件:
            社交互动: ">0"
            关系变化: ">0"
          行为选项:
            - "评估他人态度"
            - "调整自我认知"
            - "更新关系模型"
          权重因子:
            社交智慧: "×1.4"
            敏感度: "×1.1"
        
        经验总结归纳:
          行为类型: "学习行为"
          触发条件:
            经验积累: ">20"
            反思时机: ">0"
          行为选项:
            - "总结成功经验"
            - "分析失败原因"
            - "提炼行为模式"
          权重因子:
            反思能力: "×1.6"
            智慧属性: "×1.3"
    
    战斗决策分支:
      节点名称: "战斗决策分支"
      节点类型: "选择器"
      权重计算: "基于战斗状况和观点层影响"
      
      子行为:
        策略选择:
          行为类型: "战术决策"
          受观点层影响: "认知状态影响战术选择（保守/激进/灵活）"
          触发条件:
            战斗状态: "激活"
            策略需求: ">0"
          行为选项:
            - "保守防御"
            - "激进攻击"
            - "灵活机动"
            - "战术撤退"
          权重因子:
            战斗经验: "×1.5"
            勇气属性: "×1.2"
            观点层状态: "×1.8"
        
        技能释放优先级:
          行为类型: "技能选择"
          触发条件:
            技能可用: ">0"
            释放时机: "合适"
          行为选项:
            - "攻击技能"
            - "防御技能"
            - "辅助技能"
            - "特殊技能"
          权重因子:
            技能熟练度: "×1.4"
            战术需求: "×1.6"
        
        队友协作模式:
          行为类型: "团队协作"
          受立场层影响: "阵营忠诚度影响援军支援和合击技能"
          触发条件:
            队友存在: ">0"
            协作机会: ">0"
          行为选项:
            - "配合攻击"
            - "保护队友"
            - "请求支援"
            - "独立作战"
          权重因子:
            团队精神: "×1.3"
            立场层状态: "×1.7"
            阵营忠诚度: "×1.5"

  # 玩家选择介入分支配置
  玩家选择介入分支:
    分支名称: "玩家选择介入分支"
    分支类型: "玩家控制器"
    适用场景: ["剧情决策", "人生选择", "重大转折"]
    
    立场层身份分支:
      节点名称: "立场层身份分支"
      节点类型: "玩家选择器"
      触发条件: "立场相关的重要决策点"
      
      子选择:
        阵营忠诚表达:
          选择类型: "阵营立场"
          选择描述: "在阵营冲突中表达立场"
          玩家选项:
            - 选择: "坚持当前阵营"
              影响: "阵营忠诚度+20，敌对阵营关系-15"
              后续: "阵营内部地位提升事件"
            - 选择: "背叛当前阵营"
              影响: "阵营忠诚度-50，新阵营关系+30"
              后续: "背叛后果处理事件"
            - 选择: "保持中立立场"
              影响: "所有阵营关系+5，获得调解者身份"
              后续: "中立调解者路径事件"
          
          立场层影响:
            身份调整: "根据选择调整阵营身份认同"
            特权变化: "解锁或失去特定阵营特权"
            社会地位: "在相关社会圈子中的地位变化"
        
        身份角色扮演:
          选择类型: "社会身份"
          选择描述: "在社会交往中选择扮演的角色"
          玩家选项:
            - 选择: "权威领导者"
              影响: "领导力+15，责任压力+10"
              解锁: "领导决策类事件"
            - 选择: "智慧顾问"
              影响: "智慧声望+20，政治影响+10"
              解锁: "策略咨询类事件"
            - 选择: "普通参与者"
              影响: "压力-10，自由度+15"
              解锁: "平民视角类事件"
        
        利益集团选择:
          选择类型: "利益立场"
          选择描述: "在利益冲突中选择支持的集团"
          玩家选项:
            - 选择: "加入现有集团"
              影响: "集团地位+25，个人自主性-10"
              后续: "集团内部竞争事件"
            - 选择: "创建新集团"
              影响: "领导力+30，资源压力+20"
              后续: "集团建设管理事件"
            - 选择: "对抗所有集团"
              影响: "独立性+40，社会压力+25"
              后续: "孤军奋战类事件"
    
    信仰层信念分支:
      节点名称: "信仰层信念分支"
      节点类型: "玩家深度选择器"
      触发条件: "涉及核心价值观和人生信念的重大决策"
      
      子选择:
        核心价值坚守:
          选择类型: "价值观选择"
          选择描述: "在价值观冲突中的坚持或妥协"
          玩家选项:
            - 选择: "坚持核心价值"
              影响: "信念坚定度+30，外部压力+15"
              解锁: "价值观传播类事件"
              信仰层影响: "信念确立，修身境界提升"
            - 选择: "适度妥协调整"
              影响: "适应能力+20，信念纯度-10"
              解锁: "平衡智慧类事件"
              信仰层影响: "信念灵活化，实用智慧提升"
            - 选择: "彻底改变价值观"
              影响: "价值观重构+40，身份认同危机+20"
              解锁: "价值观重建类事件"
              信仰层影响: "信念重塑，可能境界跃迁或倒退"
        
        道德底线维护:
          选择类型: "道德选择"
          选择描述: "面临道德冲突时的选择"
          玩家选项:
            - 选择: "坚守道德底线"
              影响: "道德感+25，可能承受损失"
              解锁: "道德楷模类事件"
              特殊能力: "解锁仁爱技能系列"
            - 选择: "为了大义突破底线"
              影响: "实用主义+20，道德负担+15"
              解锁: "复杂道德类事件"
              特殊能力: "解锁权衡智慧技能"
            - 选择: "完全放弃道德约束"
              影响: "自由度+30，社会认同-25"
              解锁: "道德沦丧类事件"
              特殊能力: "解锁虚无技能系列"
        
        精神追求实现:
          选择类型: "修身路径"
          选择描述: "选择精神修养和人生追求的方向"
          玩家选项:
            - 选择: "追求至圣境界"
              影响: "修身点数+50，世俗束缚+20"
              解锁: "修身五境进阶事件"
              修身影响: "向至圣境发展"
            - 选择: "平衡世俗与精神"
              影响: "平衡智慧+30，修身进度+20"
              解锁: "世俗智慧类事件"
              修身影响: "理性境稳固发展"
            - 选择: "专注世俗成就"
              影响: "世俗成就+40，精神追求-15"
              解锁: "世俗成功类事件"
              修身影响: "社会境深化发展"

# ==================== 四层状态机配置 ====================
状态机系统:
  # 事实层状态机
  事实层状态机:
    状态机名称: "事实层状态机"
    控制类型: "AI自动控制"
    更新频率: "实时"
    适用角色: ["所有角色"]
    
    状态定义:
      日常生活:
        状态ID: "DAILY_LIFE"
        状态描述: "正常的日常生活状态"
        触发条件:
          压力水平: "<30"
          任务紧急度: "<20"
          健康状况: ">70"
        状态效果:
          技能学习效率: "+10%"
          社交互动频率: "正常"
          资源消耗: "标准"
        可转换状态: ["学习成长", "社交互动", "危机应对"]
      
      学习成长:
        状态ID: "LEARNING_GROWTH"
        状态描述: "专注于技能学习和能力提升"
        触发条件:
          学习机会: ">0"
          学习动机: ">50"
          时间充裕: ">40"
        状态效果:
          技能经验获得: "+50%"
          社交活动: "-20%"
          专注力消耗: "+30%"
        玩法联动: "解锁高级技能学习选项"
        可转换状态: ["日常生活", "技能实践", "社交互动"]
      
      社交互动:
        状态ID: "SOCIAL_INTERACTION"
        状态描述: "积极参与社交活动和人际交往"
        触发条件:
          社交需求: ">40"
          社交机会: ">0"
          情绪状态: "积极"
        状态效果:
          人际关系发展: "+40%"
          信息获取: "+30%"
          个人时间: "-25%"
        玩法联动: "解锁合作任务和情报获取"
        可转换状态: ["日常生活", "学习成长", "危机应对"]
      
      危机应对:
        状态ID: "CRISIS_RESPONSE"
        状态描述: "面临危机时的应急状态"
        触发条件:
          威胁等级: ">60"
          紧急事件: "发生"
          生存压力: ">50"
        状态效果:
          反应速度: "+60%"
          决策效率: "+40%"
          长期规划: "-50%"
        玩法联动: "解锁应急技能和危机处理选项"
        可转换状态: ["日常生活", "技能实践"]
      
      技能实践:
        状态ID: "SKILL_PRACTICE"
        状态描述: "将学到的技能应用到实际情况中"
        触发条件:
          技能水平: ">30"
          实践机会: ">0"
          实践动机: ">40"
        状态效果:
          技能熟练度: "+70%"
          实战经验: "+50%"
          理论学习: "-30%"
        玩法联动: "解锁高级技能应用和创新"
        可转换状态: ["日常生活", "学习成长", "危机应对"]

  # 观点层状态机
  观点层状态机:
    状态机名称: "观点层状态机"
    控制类型: "半自动控制"
    更新频率: "定期"
    适用角色: ["主角", "重要NPC"]
    
    状态定义:
      认知稳定:
        状态ID: "COGNITIVE_STABLE"
        状态描述: "认知体系稳定，观点清晰"
        触发条件:
          认知冲突: "<20"
          信息一致性: ">80"
          经验支撑: ">60"
        状态效果:
          决策效率: "+30%"
          学习新知识: "正常"
          观点改变阻力: "+40%"
        战斗联动: "技能释放稳定，命中率+10%"
        可转换状态: ["信息冲突", "认知升华"]
      
      信息冲突:
        状态ID: "INFORMATION_CONFLICT"
        状态描述: "接收到与现有认知冲突的信息"
        触发条件:
          新信息冲突度: ">50"
          认知开放度: ">30"
        状态效果:
          思考深度: "+50%"
          决策犹豫: "+30%"
          学习动机: "+40%"
        玩家控制选项:
          - 选择: "深入思考"
            效果: "向观点重塑转换"
            资源消耗: "智慧点数-10"
          - 选择: "拒绝接受"
            效果: "向偏见固化转换"
            效果加成: "意志力+15"
        战斗联动: "技能选择犹豫，行动延迟+1回合"
        可转换状态: ["观点重塑", "偏见固化", "认知稳定"]
      
      观点重塑:
        状态ID: "VIEWPOINT_RESHAPING"
        状态描述: "正在重新构建认知体系"
        触发条件:
          认知开放度: ">60"
          重塑动机: ">50"
        状态效果:
          学习效率: "+60%"
          创新思维: "+40%"
          行为不稳定: "+20%"
        玩家控制选项:
          - 投入智慧点数加速重塑过程
          - 选择重塑方向（理性/感性/平衡）
        战斗联动: "解锁创新战术，但稳定性-20%"
        可转换状态: ["认知升华", "认知稳定"]
      
      认知升华:
        状态ID: "COGNITIVE_SUBLIMATION"
        状态描述: "认知能力得到显著提升"
        触发条件:
          智慧积累: ">80"
          重塑成功: "完成"
        状态效果:
          洞察力: "+80%"
          战略思维: "+60%"
          教导他人: "+50%"
        战斗联动: "解锁洞察技能，看穿敌人弱点"
        特殊能力: "可以引导他人进行认知升华"
        可转换状态: ["认知稳定"]
      
      偏见固化:
        状态ID: "PREJUDICE_SOLIDIFICATION"
        状态描述: "拒绝新信息，固守原有观点"
        触发条件:
          认知封闭度: ">70"
          防御心理: ">60"
        状态效果:
          观点坚定度: "+100%"
          学习新知识: "-60%"
          特定领域专精: "+40%"
        战斗联动: "对特定敌人伤害+30%，但策略选择受限"
        特殊效果: "获得意志力加成，但失去部分适应性"
        可转换状态: ["信息冲突", "认知稳定"]

  # 立场层状态机
  立场层状态机:
    状态机名称: "立场层状态机"
    控制类型: "玩家主导控制"
    更新频率: "事件触发"
    适用角色: ["主角", "阵营领袖"]
    
    状态定义:
      身份确认:
        状态ID: "IDENTITY_CONFIRMATION"
        状态描述: "对当前身份和立场有清晰认知"
        触发条件:
          身份认同度: ">70"
          立场一致性: ">80"
        状态效果:
          阵营行动效率: "+40%"
          身份特权: "完全激活"
          立场冲突抗性: "+30%"
        战斗联动: "阵营技能威力+25%"
        可转换状态: ["立场动摇", "立场坚定"]
      
      立场动摇:
        状态ID: "STANCE_WAVERING"
        状态描述: "对当前立场产生怀疑"
        触发条件:
          利益冲突: ">40"
          价值观冲突: ">30"
        状态效果:
          决策犹豫: "+40%"
          身份特权: "部分失效"
          转换机会: "增加"
        玩家控制选项:
          - 选择: "坚持原则"
            效果: "向身份确认转换"
            资源消耗: "意志力-15"
          - 选择: "寻求妥协"
            效果: "向身份转换准备"
            获得: "缓冲时间+3天"
          - 选择: "彻底转变"
            效果: "向身份转换转换"
            资源消耗: "声望-20"
        战斗联动: "技能威力不稳定，±20%随机波动"
        可转换状态: ["身份确认", "身份转换", "身份危机"]
      
      身份转换:
        状态ID: "IDENTITY_TRANSITION"
        状态描述: "正在改变身份认同和立场"
        触发条件:
          转换决心: ">60"
          新身份接纳度: ">40"
        状态效果:
          旧身份特权: "逐渐失效"
          新身份特权: "逐渐激活"
          社会关系: "重新调整"
        玩家控制选项:
          - 投入声望资源加速转换
          - 选择转换策略（激进/渐进/秘密）
        战斗联动: "可以使用双重身份技能，但消耗+50%"
        资源消耗: "声望资源持续消耗"
        可转换状态: ["身份确认", "身份危机"]
      
      立场坚定:
        状态ID: "STANCE_FIRM"
        状态描述: "立场极其坚定，不易动摇"
        触发条件:
          立场坚定度: ">90"
          信念支撑: ">80"
        状态效果:
          身份特权: "超级激活+50%"
          立场冲突免疫: "+80%"
          影响他人: "+60%"
        战斗联动: "同阵营队友合击技威力+50%"
        特殊能力: "可以坚定他人立场"
        可转换状态: ["身份确认"]
      
      身份危机:
        状态ID: "IDENTITY_CRISIS"
        状态描述: "身份认同出现严重危机"
        触发条件:
          身份冲突: ">80"
          支撑体系崩塌: "发生"
        状态效果:
          所有身份特权: "失效"
          决策能力: "-50%"
          创新可能: "+100%"
        战斗联动: "所有队友关系-20%，但获得孤注一掷技能"
        玩家控制选项:
          - 选择: "重建身份"
            效果: "向身份转换转换"
            资源消耗: "修身点数-30"
          - 选择: "接受危机"
            效果: "获得特殊身份：自由者"
            特殊能力: "不受任何身份束缚"
        可转换状态: ["身份转换", "立场动摇"]

  # 信仰层状态机
  信仰层状态机:
    状态机名称: "信仰层状态机"
    控制类型: "重大选择控制"
    更新频率: "重大节点"
    适用角色: ["主角", "精神导师"]
    
    状态定义:
      信念坚定:
        状态ID: "BELIEF_FIRM"
        状态描述: "核心信念坚定不移"
        触发条件:
          信念强度: ">80"
          信念一致性: ">90"
        状态效果:
          精神力量: "+100%"
          道德光环: "激活"
          信念传播: "+80%"
        战斗联动: "信念系技能威力+100%"
        特殊能力: "可以净化他人心灵"
        可转换状态: ["信仰升华"]
      
      信仰质疑:
        状态ID: "FAITH_QUESTIONING"
        状态描述: "对核心信仰产生质疑"
        触发条件:
          重大道德冲突: "发生"
          信念冲击: ">60"
        状态效果:
          精神力量: "-30%"
          思辨能力: "+60%"
          信念重构机会: "开启"
        玩家控制选项:
          - 选择: "深入探索"
            效果: "向信念重建转换"
            获得: "哲学思辨+30"
          - 选择: "回归传统"
            效果: "向信念坚定转换"
            资源消耗: "质疑精神-20"
          - 选择: "创立新信念"
            效果: "向信念重建转换"
            资源消耗: "修身点数-50"
        战斗联动: "信念技能不稳定，效果随机"
        可转换状态: ["信念重建", "信念坚定", "信念崩塌"]
      
      信念重建:
        状态ID: "BELIEF_RECONSTRUCTION"
        状态描述: "正在重新构建核心信念体系"
        触发条件:
          重建决心: ">70"
          哲学基础: ">50"
        状态效果:
          创造力: "+100%"
          精神不稳定: "+50%"
          新信念萌芽: "进行中"
        玩家控制选项:
          - 消耗修身点数加速重建
          - 选择信念基础（理性/感性/直觉/传统）
          - 选择信念范围（个人/家族/社会/宇宙）
        战斗联动: "可能觉醒全新技能系列"
        资源消耗: "修身点数持续消耗"
        可转换状态: ["信仰升华", "信念坚定", "信念崩塌"]
      
      信仰升华:
        状态ID: "FAITH_SUBLIMATION"
        状态描述: "信仰达到超凡境界"
        触发条件:
          修身境界: "至圣境"
          信念纯度: ">95"
        状态效果:
          精神力量: "+200%"
          超凡能力: "激活"
          信仰传播: "+150%"
        战斗联动: "解锁圣光系列技能，对邪恶敌人额外伤害"
        特殊能力: "可以进行信仰启蒙，帮助他人觉醒"
        终极状态: "修身五境的最高体现"
        可转换状态: ["信念坚定"]
      
      信念崩塌:
        状态ID: "BELIEF_COLLAPSE"
        状态描述: "核心信念体系完全崩塌"
        触发条件:
          信念冲击: ">90"
          支撑体系: "完全破坏"
        状态效果:
          精神力量: "-80%"
          虚无感: "+100%"
          重建可能: "极低但存在"
        战斗联动: "解锁虚无系列技能，免疫精神攻击但无法使用治疗技能"
        玩家控制选项:
          - 选择: "重新开始"
            效果: "向信念重建转换"
            资源消耗: "所有修身点数清零"
          - 选择: "接受虚无"
            效果: "获得特殊状态：虚无者"
            特殊能力: "免疫所有精神影响"
        危险状态: "可能导致角色精神死亡"
        可转换状态: ["信念重建"]

# ==================== 状态转换规则 ====================
状态转换规则:
  全局规则:
    转换冷却: "同一状态机内状态转换需要冷却时间"
    跨层影响: "上层状态变化可能触发下层状态转换"
    玩家干预: "玩家可以在特定条件下强制触发状态转换"
    资源消耗: "某些状态转换需要消耗特定资源"
  
  紧急转换:
    触发条件: "生命威胁、重大事件、极端情况"
    转换规则: "可以跳过正常转换限制"
    后果: "可能产生负面效果或不稳定状态"
  
  渐进转换:
    触发条件: "长期积累、缓慢变化"
    转换规则: "需要满足多个条件才能完成"
    优势: "转换后状态更加稳定"

# ==================== 战斗系统联动 ====================
战斗系统联动:
  观点层联动:
    认知升华状态: "解锁洞察技能，看穿敌人弱点，命中率+30%"
    偏见固化状态: "对特定类型敌人伤害+30%，但战术选择受限"
    信息冲突状态: "技能选择犹豫，行动延迟+1回合"
  
  立场层联动:
    立场坚定状态: "同阵营队友合击技威力+50%"
    身份危机状态: "所有队友关系-20%，但获得孤注一掷技能"
    身份转换状态: "可以使用双重身份技能，但消耗+50%"
  
  信仰层联动:
    信仰升华状态: "解锁圣光系列技能，对邪恶敌人额外伤害+100%"
    信念崩塌状态: "解锁虚无系列技能，免疫精神攻击但无法使用治疗技能"
    信念重建状态: "可能觉醒全新技能系列，效果未知"
  
  压力状态联动:
    道德压力: "可能导致技能失误，也可能激发潜能"
    生存压力: "提升反应速度和爆发力"
    社会压力: "影响团队协作效果"